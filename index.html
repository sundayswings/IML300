<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>watery</title>
    <link rel="stylesheet" href="wave.css" />

    <!--  p5.js  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/addons/p5.sound.min.js"></script>
    <link rel="stylesheet" href="index.css" />

    <!-- paper.js   -->
    <script type="text/javascript" src="paper-full.js"></script>
    <script type="text/paperscript" canvas="canvas">
      // Code ported to Paper.js from http://the389.com/9/1/
      // with permission.

      var values = {
          friction: 0.8,
          timeStep: 0.01,
          amount: 15,
          mass: 2,
          count: 0
      };
      values.invMass = 1 / values.mass;

      var path, springs;
      var size = view.size * [1.2, 1];

      var Spring = function(a, b, strength, restLength) {
          this.a = a;
          this.b = b;
          this.restLength = restLength || 80;
          this.strength = strength ? strength : 0.55;
          this.mamb = values.invMass * values.invMass;
      };

      Spring.prototype.update = function() {
          var delta = this.b - this.a;
          var dist = delta.length;
          var normDistStrength = (dist - this.restLength) /
                  (dist * this.mamb) * this.strength;
          delta.y *= normDistStrength * values.invMass * 0.2;
          if (!this.a.fixed)
              this.a.y += delta.y;
          if (!this.b.fixed)
              this.b.y -= delta.y;
      };


      function createPath(strength) {
          var path = new Path({
              fillColor: 'black'
          });
          springs = [];
          for (var i = 0; i <= values.amount; i++) {
              var segment = path.add(new Point(i / values.amount, 0.5) * size);
              var point = segment.point;
              if (i == 0 || i == values.amount)
                  point.y += size.height;
              point.px = point.x;
              point.py = point.y;
              // The first two and last two points are fixed:
              point.fixed = i < 2 || i > values.amount - 2;
              if (i > 0) {
                  var spring = new Spring(segment.previous.point, point, strength);
                  springs.push(spring);
              }
          }
          path.position.x -= size.width / 4;
          return path;
      }

      function onResize() {
          if (path)
              path.remove();
          size = view.bounds.size * [2, 1];
          path = createPath(0.1);
      }

      function onMouseMove(event) {
          var location = path.getNearestLocation(event.point);
          var segment = location.segment;
          var point = segment.point;

          if (!point.fixed && location.distance < size.height / 4) {
              var y = event.point.y;
              point.y += (y - point.y) / 6;
              var previous = segment.previous && segment.previous.point;
              var next = segment.next && segment.next.point;
              if (previous && !previous.fixed)
                  previous.y += (y - previous.y) / 24;
              if (next && !next.fixed)
                  next.y += (y - next.y) / 24;
          }
      }

      function onFrame(event) {
          updateWave(path);
      }

      function updateWave(path) {
          var force = 1 - values.friction * values.timeStep * values.timeStep;
          for (var i = 0, l = path.segments.length; i < l; i++) {
              var point = path.segments[i].point;
              var dy = (point.y - point.py) * force;
              point.py = point.y;
              point.y = Math.max(point.y + dy, 0);
          }

          for (var j = 0, l = springs.length; j < l; j++) {
              springs[j].update();
          }
          path.smooth({ type: 'continuous' });
      }

      function onKeyDown(event) {
          if (event.key == 'space') {
              path.fullySelected = !path.fullySelected;
              path.fillColor = path.fullySelected ? null : 'black';
          }
      }
    </script>
    <style>
      canvas {
        opacity: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1; /* Change to a lower value */
      }
      video {
        z-index: 2;
        width: 160px; /* Set the desired width */
        height: auto;
      }
      #typedText {
        z-index: 4;
        
        font-family: "Georgia";
      }
      #intro {
        margin-top: 240px;
        margin-left: 40px;
        
        color: white;
      }
      
      .video-container {
        width: 180px;
        height: auto;
        
        margin-left: auto;
        margin-right: auto;
      }
      

      video {
        width: 170px; /* Set the desired width */
        height: auto; /* Maintain aspect ratio */
        
        margin-top: 30px;
        
      }
      a {
        color: white;
        /*         display: none; */
      }
    </style>
  </head>
  <body>
    <a href="all.html"></a>
    <canvas id="canvas" resize hidpi="off"></canvas>
    
    <div id="intro">
      <div id="typedText">
      </div>
    </div>
    

    <div class="video-container">
      <video width="100%" height="100%" muted autoplay loop>
        <source
          src="https://cdn.glitch.me/6b0f94bc-510d-432f-9896-1187d4b4ffcb/video.mp4?v=1713999788772"
          type="video/mp4"
        />
        Your browser does not support the video tag.
      </video>
    </div>

    <script>
      var aText = new Array(
        "There are more than 10.7 million Chinese overseas today – about 60 million, if their descendants are included.",
        "The history of Chinese migration is ancient. It began with the opening of the maritime Silk Road over 2,000 years ago, with immigrants moving mainly to Southeast Asia.",
        "By the early 15th century, several Chinatowns – each hosting thousands of overseas Chinese – were established in Sumatra and Java (present-day Indonesia).",
        "<p>*</p>But it was at the end of the sixteenth century that large-scale migration began.<br>They were mainly engaged in trade and crafts, with most of them settled in Southeast Asia.",
        "From the middle of the 19th century to the early 1940s, a second wave of migration started in China. Unskilled labourers, or so-called “Chinese contracted coolies”, formed a major part of this wave.<br>This was the beginning of the dispersion of the Chinese across the world – from Southeast Asia to America, Africa, Europe, and Australia.",
        "<p>*</p>A third wave of new Chinese migrants started in the 1980s, and was an integral part of the surge of global migration.<br>They moved mainly to industrialized countries – the top destination for overseas Chinese at the time was the United States.",
        "<a href='tree.html'><h3>see grafting</h3></a>",
      );


      var iSpeed = 10;
      var iIndex = 0;
      var iArrLength = aText[0].length;
      var iScrollAt = 20;
      var iTextPos = 0;
      var sContents = "";
      var iRow;

      function typewriter() {
        sContents = " ";
        iRow = Math.max(0, iIndex - iScrollAt);
        var destination = document.getElementById("typedText");

        while (iRow < iIndex) {
          sContents += aText[iRow++] + "<br /><br />";
        }
        destination.innerHTML =
          sContents + aText[iIndex].substring(0, iTextPos) + "_";
        if (iTextPos++ == iArrLength) {
          iTextPos = 0;
          iIndex++;
          if (iIndex != aText.length) {
            iArrLength = aText[iIndex].length;
            setTimeout("typewriter()", 500);
          }
        } else {
          setTimeout("typewriter()", iSpeed);
        }
      }
      typewriter();
    </script>
  </body>
</html>
